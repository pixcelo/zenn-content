---
title: "C#で音声認識「Whisperをローカルで使う」"
emoji: "🎤"
type: "tech"
topics: ["csharp", "dotnet", "音声認識", "whisper", "ai"]
published: false
publication_name: "nexta_"
---

## はじめに

C#で音声を扱う方法を調べました。
主に以下の処理を、手元で環境構築してやってみた感じです。

- 音声入力
- 音声認識
- 文字おこし

## 作ったもの

文字起こしができるアプリを作りました。

フレームワークは Windows Formです。
デザインは適当です。
モデル取得以外は、オフラインで動きます。

録音にはNAudioを使用。

（NAudioの簡単な説明をここに入れる）

これを使ってマイクとPC音の両方を試すと、問題なくキャプチャできました。
録音された音声ファイルはwavとしてセットされます。

次に、音声認識。
OpenAIの開発したWhisperのOSS版を使いました。
Whisper.cppを.Netで扱えるようにしたWhisper.netです。

（Whisper.cppとWhisper.netの説明を入れる）

アプリ上でモデルを選べるようにしています。
モデルを選ぶとHaggingFaceからモデルを取得します。

（モデルの説明をする）

文字起こし実行ボタンを押すと

## 感想

Medium でも音声認識は厳しい。
PCマイクで実行すると、周りの声も拾ってうまくいかない。
音声ファイルの長さに比例して、変換時間も増える。（時間が掛かる）

音声認識の精度が悪いとストレス
音声コマンドは、短くて分かりやすいのが良さそう
ハンズフリー操作とかに応用できそう