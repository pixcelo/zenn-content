@* カスタム入力コンポーネント：双方向バインディング対応 *@

<div class="custom-input-wrapper">
    <label class="form-label">@Label</label>
    <div class="input-group">
        @if (!string.IsNullOrEmpty(Prefix))
        {
            <span class="input-group-text">@Prefix</span>
        }
        <input type="@InputType"
               class="form-control @(IsValid ? "" : "is-invalid")"
               value="@Value"
               @oninput="OnInputChanged"
               placeholder="@Placeholder" />
        @if (!string.IsNullOrEmpty(Suffix))
        {
            <span class="input-group-text">@Suffix</span>
        }
    </div>
    @if (!string.IsNullOrEmpty(ValidationMessage))
    {
        <div class="invalid-feedback d-block">@ValidationMessage</div>
    }
    @if (!string.IsNullOrEmpty(HelpText))
    {
        <small class="form-text text-muted">@HelpText</small>
    }
</div>

@code {
    /// <summary>
    /// ラベルテキスト
    /// </summary>
    [Parameter]
    public string Label { get; set; } = "";

    /// <summary>
    /// 入力値（双方向バインディング）
    /// </summary>
    [Parameter]
    public string Value { get; set; } = "";

    /// <summary>
    /// 値変更時のコールバック（双方向バインディング用）
    /// </summary>
    [Parameter]
    public EventCallback<string> ValueChanged { get; set; }

    /// <summary>
    /// プレースホルダーテキスト
    /// </summary>
    [Parameter]
    public string Placeholder { get; set; } = "";

    /// <summary>
    /// input要素のtype属性
    /// </summary>
    [Parameter]
    public string InputType { get; set; } = "text";

    /// <summary>
    /// 入力フィールドの前に表示するテキスト
    /// </summary>
    [Parameter]
    public string Prefix { get; set; } = "";

    /// <summary>
    /// 入力フィールドの後ろに表示するテキスト
    /// </summary>
    [Parameter]
    public string Suffix { get; set; } = "";

    /// <summary>
    /// ヘルプテキスト
    /// </summary>
    [Parameter]
    public string HelpText { get; set; } = "";

    /// <summary>
    /// バリデーションメッセージ
    /// </summary>
    [Parameter]
    public string ValidationMessage { get; set; } = "";

    /// <summary>
    /// バリデーション状態
    /// </summary>
    [Parameter]
    public bool IsValid { get; set; } = true;

    private async Task OnInputChanged(ChangeEventArgs e)
    {
        Value = e.Value?.ToString() ?? "";
        await ValueChanged.InvokeAsync(Value);
    }
}
