# Playwright MCP テストシナリオ

このドキュメントでは、Blazor Server + Radzen ComponentsアプリケーションをPlaywright MCPでテストする際のサンプルシナリオを紹介します。

## 前提条件

1. アプリケーションが起動していること（`dotnet run`）
2. Playwright MCPサーバーが設定されていること
3. ブラウザが利用可能なこと

## テストシナリオ1: フォームの基本入力テスト

### 目的
Test Formページのすべての入力フィールドに値を入力し、送信できることを確認する

### 手順（AIエージェントへの指示例）

```
http://localhost:5000/test-form にアクセスして、以下の操作を実行してください：

1. Nameフィールドに "John Doe" と入力
2. Emailフィールドに "john@example.com" と入力
3. Ageフィールドに "30" と入力
4. Countryドロップダウンから "USA" を選択
5. "Subscribe to newsletter" チェックボックスをチェック
6. Commentsテキストエリアに "This is a test comment" と入力
7. Submitボタンをクリック
8. 成功メッセージが表示されることを確認
```

### 期待結果
- すべてのフィールドに正しく値が入力される
- 送信後、緑色の成功アラートが表示される
- アラートに入力したNameとEmailが含まれている

## テストシナリオ2: バリデーションテスト

### 目的
必須フィールドのバリデーションが正しく動作することを確認する

### 手順（AIエージェントへの指示例）

```
http://localhost:5000/test-form にアクセスして、以下の操作を実行してください：

1. 何も入力せずにSubmitボタンをクリック
2. "Name is required" エラーメッセージが表示されることを確認
3. Nameフィールドに "Test User" と入力
4. Emailフィールドに無効な形式 "invalid-email" を入力
5. Submitボタンをクリック
6. "Invalid email format" エラーメッセージが表示されることを確認
```

### 期待結果
- 必須フィールドが空の場合、適切なエラーメッセージが表示される
- メール形式が不正な場合、バリデーションエラーが表示される
- エラーがある状態では送信されない

## テストシナリオ3: クリア機能のテスト

### 目的
Clearボタンでフォームがリセットされることを確認する

### 手順（AIエージェントへの指示例）

```
http://localhost:5000/test-form にアクセスして、以下の操作を実行してください：

1. Nameフィールドに "Jane Smith" と入力
2. Emailフィールドに "jane@example.com" と入力
3. Ageフィールドに "25" と入力
4. Clearボタンをクリック
5. すべてのフィールドが初期状態にリセットされることを確認
```

### 期待結果
- すべてのテキストフィールドが空になる
- 数値フィールドが0にリセットされる
- ドロップダウンがデフォルト値（Japan）にリセットされる
- チェックボックスがオフになる
- 成功メッセージが消える

## テストシナリオ4: ナビゲーションテスト

### 目的
アプリケーション内のページ遷移が正しく動作することを確認する

### 手順（AIエージェントへの指示例）

```
http://localhost:5000 にアクセスして、以下の操作を実行してください：

1. サイドバーの "Test Form" リンクをクリック
2. URLが /test-form に変更されることを確認
3. "AI Agent Test Form" というヘッダーが表示されることを確認
4. サイドバーの "Home" リンクをクリック
5. ホームページに戻ることを確認
```

### 期待結果
- リンクをクリックすると対応するページに遷移する
- URLが正しく変更される
- ページコンテンツが正しく表示される

## テストシナリオ5: Radzen Componentsの動作確認

### 目的
Radzen Componentsが正しくレンダリングされ、操作できることを確認する

### 手順（AIエージェントへの指示例）

```
http://localhost:5000/test-form にアクセスして、以下を確認してください：

1. RadzenCardコンポーネントが表示されていることを確認
2. RadzenDropDownをクリックして、オプションリストが表示されることを確認
3. 各オプション（USA, Japan, UK, Germany, France, Canada）が選択可能であることを確認
4. RadzenNumericコンポーネントで数値の増減ボタンが機能することを確認
```

### 期待結果
- すべてのRadzenコンポーネントが正しくレンダリングされる
- ドロップダウンリストが正しく展開される
- 数値入力の増減ボタンが機能する

## Playwright MCP使用時のヒント

### よく使うコマンド

1. **ページへのアクセス**
   ```
   Navigate to http://localhost:5000/test-form
   ```

2. **要素の検索と入力**
   ```
   Find the input field with name "Name" and type "John Doe"
   ```

3. **ボタンのクリック**
   ```
   Click the button with text "Submit"
   ```

4. **要素の検証**
   ```
   Verify that an alert with text "Form submitted successfully" is displayed
   ```

5. **スクリーンショット撮影**
   ```
   Take a screenshot of the current page
   ```

### トラブルシューティング

- **要素が見つからない場合**: Blazor Serverの動的レンダリングを待つ必要があります。少し待機してから再試行してください。
- **SignalR接続エラー**: アプリケーションが完全に起動するまで待機してください。
- **タイムアウトエラー**: ネットワークが遅い場合、タイムアウト時間を延長してください。

## テストシナリオ6: DataGridの表示とフィルタリング

### 目的
Radzen DataGridが正しくデータを表示し、フィルタリング機能が動作することを確認する

### 手順（AIエージェントへの指示例）

```
http://localhost:5000/data-grid にアクセスして、以下の操作を実行してください：

1. データグリッドに12件の商品データが表示されていることを確認
2. "Category" 列のフィルタリング機能を使用して "Electronics" でフィルタ
3. フィルタされた結果が表示されることを確認
4. フィルタをクリアして全データが再表示されることを確認
```

### 期待結果
- 12件のサンプル商品データが表示される
- フィルタリングが正しく動作する
- 各列（ID、Product Name、Category、Price、Stock、Active）が表示される
- Stockの値に応じてバッジの色が変わる（0:赤、1-9:黄、10以上:緑）

## テストシナリオ7: DataGridのソートとページング

### 目的
DataGridのソート機能とページング機能が正しく動作することを確認する

### 手順（AIエージェントへの指示例）

```
Data Gridページで、以下の操作を実行してください：

1. "Price" 列のヘッダーをクリックして価格で昇順ソート
2. 最も安い商品が最初に表示されることを確認
3. もう一度クリックして降順ソートに変更
4. ページングコントロールを使用して次のページに移動（10件表示の場合）
5. 2ページ目のデータが表示されることを確認
```

### 期待結果
- 列ヘッダークリックでソートが切り替わる
- ソート方向（昇順/降順）が正しく機能する
- ページングで正しくページが切り替わる
- 1ページあたり10件が表示される

## テストシナリオ8: DataGridの編集機能

### 目的
DataGridの編集・削除機能が正しく動作することを確認する

### 手順（AIエージェントへの指示例）

```
Data Gridページで、以下の操作を実行してください：

1. 最初の商品（Laptop）の編集ボタン（鉛筆アイコン）をクリック
2. 編集フォームが表示されることを確認
3. Priceを "1499.99" に変更
4. Stockを "20" に変更
5. Saveボタンをクリック
6. グリッド上の値が更新されることを確認
7. 成功メッセージが表示されることを確認
```

### 期待結果
- 編集ボタンクリックで編集フォームが表示される
- 変更内容が正しく保存される
- グリッドの表示が更新される
- 成功メッセージが表示される

## テストシナリオ9: DataGridの削除機能

### 目的
DataGridから商品を削除できることを確認する

### 手順（AIエージェントへの指示例）

```
Data Gridページで、以下の操作を実行してください：

1. 現在の商品数を確認
2. 任意の商品の削除ボタン（ゴミ箱アイコン）をクリック
3. 商品がグリッドから削除されることを確認
4. 削除成功メッセージが表示されることを確認
5. 商品数が1件減っていることを確認
```

### 期待結果
- 削除ボタンクリックで商品が削除される
- グリッドから該当行が消える
- 削除成功メッセージが表示される
- データ件数が減る

## テストシナリオ10: DataGridのデータ操作

### 目的
DataGridのサンプルデータ追加とクリア機能が正しく動作することを確認する

### 手順（AIエージェントへの指示例）

```
Data Gridページで、以下の操作を実行してください：

1. "Clear All" ボタンをクリック
2. グリッドが空になることを確認
3. "クリア完了" メッセージが表示されることを確認
4. "Add Sample Data" ボタンをクリック
5. 12件のサンプルデータが追加されることを確認
6. "Export to CSV" ボタンが有効になることを確認
```

### 期待結果
- Clear Allでデータが全削除される
- Add Sample Dataで12件のデータが追加される
- データがない時はExport to CSVボタンが無効化される
- データがある時はExport to CSVボタンが有効になる

## 次のステップ

これらのシナリオを基に、AIエージェントと対話しながら自動テストを実行してみてください。Playwright MCPを使用することで、自然言語でテストシナリオを指示できます。
